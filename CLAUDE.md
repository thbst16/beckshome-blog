# Beckshome Blog Migration Guide

## Project Overview

**Goal:** Migrate from Statiq.net to Hugo + PaperMod theme
**Target URL:** `blog.beckshome.com`
**Deployment:** GitHub Pages with GitHub Actions
**Repository:** `github.com/thbst16/dotnet-statiq-beckshome-blog`

---

## Current State (Statiq.net)

### Directory Structure
```
beckshome-blog/
├── input/                    # Content source
│   ├── posts/                # 129 markdown blog posts
│   ├── about.md              # About page
│   ├── _index.yml            # Site metadata
│   ├── settings.yml          # Statiq settings
│   ├── _directory.yml        # URL routing config
│   ├── web.config            # Azure IIS rewrite rules
│   └── img/mermaid/          # Mermaid diagram sources (.mmd)
├── theme/input/              # Statiq theme files
│   ├── *.cshtml              # Razor templates
│   ├── scss/                 # Stylesheets
│   ├── js/                   # JavaScript
│   ├── vendor/               # Bootstrap, jQuery, FontAwesome
│   ├── dist/                 # EnlighterJS syntax highlighting
│   └── img/                  # Theme background images
├── Program.cs                # Statiq entry point
├── statiq-site.csproj        # .NET 7 project
├── package.json              # Mermaid CLI dependency
└── build-mermaid.sh          # Mermaid build script
```

### Blog Post Statistics
- **Total Posts:** 129
- **Date Range:** 2006-2022
- **Format:** Markdown with YAML frontmatter

### Current Frontmatter Format
```yaml
---
Title: "Post Title Here"
Published: M/DD/YYYY
Tags:
    - Tag1
    - Tag2
---
```

**Key characteristics:**
- Field names are **capitalized** (Title, Published, Tags)
- `Published` uses **M/DD/YYYY** format (e.g., `9/10/2022`, `2/27/2007`)
- Tags use **indented list format** (4 spaces)
- Minimal metadata (no images, descriptions, draft status)
- Title may be quoted or unquoted

### Image Hosting
- **All content images are hosted externally** on AWS S3
- URL pattern: `https://s3.amazonaws.com/s3.beckshome.com/[filename]`
- Only local images: 3 mermaid .mmd diagram source files
- Theme images in `/theme/input/img/` (background images)

### Current URL Structure
Generated by `_directory.yml`:
```
/YYYY/MM/post-slug.html
```
Example: `/2022/09/beckshome-on-statiq.html`

### Features to Preserve
- Giscus comments (GitHub Discussions)
- EnlighterJS syntax highlighting → Hugo built-in or Chroma
- RSS feed at `/feed.rss`
- Tag-based navigation
- Search functionality
- About page

---

## Target State (Hugo + PaperMod)

### Target Directory Structure
```
beckshome-blog/
├── archetypes/
│   └── default.md
├── assets/
│   └── css/extended/        # Custom CSS overrides
├── content/
│   ├── posts/               # Migrated blog posts
│   ├── archives.md          # Archives page
│   ├── search.md            # Search page
│   └── about.md             # About page
├── layouts/
│   └── partials/
│       └── comments.html    # Giscus integration
├── static/
│   ├── images/              # Local images (if any)
│   └── CNAME                # Custom domain file
├── themes/
│   └── PaperMod/            # Git submodule
├── hugo.yaml                # Main configuration
└── .github/
    └── workflows/
        └── hugo.yaml        # GitHub Actions
```

### Target Frontmatter Format
```yaml
---
title: "Post Title Here"
date: YYYY-MM-DD
tags: ["Tag1", "Tag2"]
draft: false
description: ""
summary: ""
showToc: true
TocOpen: false
cover:
  image: ""
  alt: ""
  hidden: false
---
```

---

## Migration Transformations

### Frontmatter Field Mappings

| Statiq Field | Hugo Field | Transformation |
|--------------|------------|----------------|
| `Title` | `title` | Lowercase field name |
| `Published` | `date` | Convert M/DD/YYYY → YYYY-MM-DD |
| `Tags` (indented list) | `tags` | Convert to `["tag1", "tag2"]` array |
| (none) | `draft` | Add `false` |
| (none) | `showToc` | Add `true` (optional) |
| (none) | `description` | Add empty or generate |
| (none) | `summary` | Add empty or generate |

### Date Format Conversion
```
Statiq:  9/10/2022  → Hugo: 2022-09-10
Statiq:  2/27/2007  → Hugo: 2007-02-27
Statiq: 12/25/2020  → Hugo: 2020-12-25
```

### URL Preservation
Configure Hugo permalinks to maintain existing URL structure:
```yaml
permalinks:
  posts: "/:year/:month/:slug/"
```
Note: May need `.html` extension handling or redirects.

---

## Step-by-Step Migration Process

### Phase 1: Project Setup
1. Install Hugo Extended (v0.112.4+)
2. Create Hugo site structure: `hugo new site . --force`
3. Add PaperMod theme as submodule
4. Create `hugo.yaml` configuration (see `blog-refactoring.md`)

### Phase 2: Content Migration
1. Create `content/posts/` directory
2. Copy markdown files from `input/posts/` to `content/posts/`
3. Run frontmatter transformation script:
   - Convert `Title:` → `title:`
   - Convert `Published: M/DD/YYYY` → `date: YYYY-MM-DD`
   - Convert indented Tags to array format
   - Add missing fields (draft, showToc, etc.)
4. Create required pages: `archives.md`, `search.md`
5. Migrate `about.md`

### Phase 3: Theme & Configuration
1. Configure `hugo.yaml` with PaperMod settings
2. Set up menu navigation
3. Configure search (JSON output)
4. Add Giscus comments partial
5. Add custom CSS if needed

### Phase 4: GitHub Actions
1. Create `.github/workflows/hugo.yaml`
2. Enable GitHub Pages (Settings → Pages → GitHub Actions)
3. Add `static/CNAME` with `blog.beckshome.com`

### Phase 5: Testing
1. Run `hugo server -D` locally
2. Validate all posts render correctly
3. Check images load from S3
4. Test search, tags, archives
5. Run link checker

### Phase 6: Cutover
1. Merge to main branch
2. Remove old Statiq files
3. Update DNS if needed
4. Verify deployment

---

## Files to Delete After Migration

```
input/                    # Entire directory
theme/                    # Entire directory
Program.cs
statiq-site.csproj
package.json
package-lock.json
node_modules/             # If present
build-mermaid.sh
```

---

## Important Considerations

### External Images
All content images are on S3 (`s3.amazonaws.com/s3.beckshome.com/`). No local image migration needed, but verify all S3 URLs work.

### Mermaid Diagrams
Current setup uses mermaid-cli to pre-generate SVGs. Hugo options:
1. Pre-generate SVGs (keep current approach)
2. Use Hugo mermaid shortcode with client-side rendering
3. Use a Hugo module for mermaid support

### Syntax Highlighting
Statiq uses EnlighterJS. Hugo uses Chroma built-in:
```yaml
markup:
  highlight:
    style: dracula  # or monokai, github, etc.
    codeFences: true
    guessSyntax: true
```

### Comments (Giscus)
Already using Giscus. Create `layouts/partials/comments.html` with Giscus script (repo IDs needed from giscus.app).

### URL Compatibility
Current: `/2022/09/beckshome-on-statiq.html`
Hugo default: `/posts/beckshome-on-statiq/`

Options:
1. Use `permalinks` config to match old structure
2. Create redirect aliases in frontmatter
3. Accept new URL structure (may affect SEO temporarily)

---

## Validation Checklist

### Content
- [ ] All 129 posts migrate successfully
- [ ] Frontmatter converts correctly
- [ ] No broken internal links
- [ ] Images load from S3
- [ ] Code blocks render with syntax highlighting

### Navigation
- [ ] Menu links work (Home, Posts, Archives, Tags, Search)
- [ ] Tag pages generate
- [ ] Archives page works
- [ ] Search functionality works

### Features
- [ ] RSS feed generates at `/index.xml`
- [ ] Dark/light mode toggle works
- [ ] Mobile responsive
- [ ] Giscus comments load

### Deployment
- [ ] GitHub Actions builds successfully
- [ ] GitHub Pages serves site
- [ ] Custom domain works
- [ ] HTTPS enabled

---

## Reference Files

- **Full Migration Plan:** `blog-refactoring.md`
- **Hugo Config Example:** See Phase 3 in `blog-refactoring.md`
- **GitHub Actions Workflow:** See Phase 5 in `blog-refactoring.md`

---

## Quick Commands

```bash
# Install Hugo (macOS)
brew install hugo

# Create Hugo site in existing directory
hugo new site . --force

# Add PaperMod theme
git submodule add --depth=1 https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod

# Local development
hugo server -D

# Build for production
hugo --gc --minify

# Create new post
hugo new posts/my-new-post.md
```
